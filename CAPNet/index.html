<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="description" content="CAP-Net: A Unified Network for 6D Pose and Size Estimation of Categorical  Articulated Parts from a Single RGB-D Image">
    <meta name="keywords" content="Liquid perception, Visual closed-Loop, Robotic pouring">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CAP-Net</title>
    <!-- <link rel="icon" type="image/png" href="resources/images/icon_pourit.png"> -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <!-- <nav class="navbar" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">
        <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu">
        <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
          <a class="navbar-item" href="https://hetolin.github.io">
          <span class="icon">
              <i class="fas fa-home"></i>
          </span>
          </a>

          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
              More Research
            </a>
            <div class="navbar-dropdown">
              <a class="navbar-item" href="https://hetolin.github.io/SAR-Net">
                SAR-Net: Shape Alignment and Recovery Network for Category-level 6D Object Pose and Size Estimation
              </a>
            </div>
          </div>
        </div>

      </div>
    </nav> -->


    <style>
		.render_wrapper {
			position: relative;
            height: 300px;
         }
        .render_wrapper_small {
			position: relative;
            height: 200px;
         }
		.render_div {
			position: absolute;
			top: 0;
			left: 0;
		}

        #interpolation-image-wrapper-car{
            text-align: center;
        }
        #interpolation-image-wrapper-chair{
            text-align: center;
        }
        .nested-columns {
            margin-bottom: 0 !important;
        }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
</head>

<body>

    <section class="hero">
        <div class="hero-body">
            <div class="container is-max-widescreen">
                <div class="columns is-centered">
                    <div class="column has-text-centered">
                        <div class="column is-full_width">
                            <h1 class="title is-2 publication-title">CAP-Net: A Unified Network for 6D Pose and Size Estimation of Categorical  Articulated Parts from a Single RGB-D Image</h1>
                        </div>
                        <div class="column is-full_width">
                          <h2 class="title is-3">CVPR 2025</h2>
                        </div>

                        <style>
                            .author-block {
                              margin-right: 0.5em; /* 调整水平间距 */
                              display: inline-block; /* 确保 margin 生效 */
                            }
                        </style>
                        <div class="is-size-4 publication-authors">
                            <span class="author-block">
                                <a href="">Jingshun Huang<sup>1*</sup></a>,</span>
                            <span class="author-block">
                                <a href="http://hetolin.github.io/">Haitao Lin<sup>1*</sup></a>,</span>
                            <span class="author-block">
                                <a href="https://star-uu-wang.github.io/">Tianyu Wang<sup>1</sup></a>,</span>
                            <span class="author-block">
                                <a href="">Yi Zhu<sup>2</sup></a>,</span>
                            <span class="author-block">
                                <a href="">Xiangyang Xue<sup>1†</sup></a></span>
                            <span class="author-block">
                                <a href="http://yanweifu.github.io">Yanwei Fu<sup>1†</sup></a>,</span>
                        </div>
                        <style>
                            .author-institute {
                              margin-right: 1em; /* 调整水平间距 */
                              display: inline-block; /* 确保 margin 生效 */
                            }
                        </style>
                        <div class="is-size-4 publication-authors">
                            <span class="author-institute"><sup>1</sup>Fudan University    </span>
                            <span class="author-institute"><sup>2</sup>Huawei, Noah’s Ark Lab    </span>
                        </div>
                        
                        <p style="font-size: 20px;"> <!-- 调整 18px 为想要的字号 -->
                            <sup>*</sup> equal contributions &nbsp;
                            <sup>†</sup> corresponding author &nbsp;
                            <br>
                        </p>
                        <!-- <p> <sup>*</sup> equal contributions &nbsp;
                            <sup>†</sup> corresponding author &nbsp;
                            <br>
                        </p> -->
                        <!-- <div style="text-align:center">
                            <img src="./resources/images/pourit_logo_text.jpg" width="30%" />
                        </div> -->
                        <div class="column has-text-centered">
                            <div class="publication-links">

                                <!-- PDF Link. -->
                                <span class="link-block">
                                    <a href=""
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fas fa-file-pdf"></i>
                                        </span>
                                        <span>Paper</span>
                                    </a>
                                </span>
                                <span class="link-block">
                                    <a class="external-link button is-normal is-rounded is-dark" href="">
                                        <span class="icon">
                                            <i class="ai ai-arxiv"></i>
                                        </span>
                                        <span>arXiv</span>
                                    </a>
                                </span>
                                <!-- <span class="link-block">
                                    <a href="./resources/images/arXiv_pre.pdf"
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fas fa-file-pdf"></i>
                                        </span>
                                        <span>Supp</span>
                                    </a>
                                </span> -->

                                <!-- Video Link. -->
                                <span class="link-block">
                                    <a href=""
                                        class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <svg class="svg-inline--fa fa-youtube fa-w-18" aria-hidden="true"
                                                focusable="false" data-prefix="fab" data-icon="youtube" role="img"
                                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"
                                                data-fa-i2svg="">
                                                <path fill="currentColor"
                                                    d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z">
                                                </path>
                                            </svg>
                                        </span>
                                        <span>Video</span>
                                    </a>
                                </span>

                                <!-- Github Link. -->
                                <span class="link-block">
                                    <a href="" class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fab fa-github"></i>
                                        </span>
                                        <span>Code(Coming soon)</span>
                                    </a>
                                </span>
                                <!-- Dataset Link. -->
                                <span class="link-block">
                                    <a href=" https://pan.baidu.com/s/1Yj22fXAT-rNM_92xrJx6og?pwd=phfx" class="external-link button is-normal is-rounded is-dark">

                                        <span>Dataset</span>
                                    </a>
                                </span>

                                <!-- Dataset Link. -->
                                <!-- <span class="link-block">
                                  <a href="https://drive.google.com/file/d/1X_IyPt9N9-AtqVwHWrL5nVqIuNMileTY/view?usp=share_link"
                                     class="external-link button is-normal is-rounded is-dark">
                                    <span class="icon">
                                        <i class="far fa-images"></i>
                                    </span>
                                    <span>Data</span>
                                    </a> -->


                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="hero teaser">
        <div class="container is-max-desktop">
            <div class="hero-body">
                <div align="center"><img src="./resources/fig/teaser.jpg" width="80%" /></div>
                <h2 class=" subtitle has-text-centered" style="padding-top: 10px">
                    CAP-Net is a unified approach for estimating the 6D pose and size of all articulated parts from RGB-D images, requiring only object-level masks instead of part-level ones. The realistic training images in our RGBD-Art dataset allow this synthetic-trained model to effectively adapt to real-world visual perception tasks for robotic manipulation using an affordable RealSense camera.
                </h2>
            </div>
        </div>
    </section>


    <section class="section">
        <div class="container is-max-desktop">
            <!-- Abstract. -->
            <div class="columns is-centered has-text-centered">
                <div class="column is-four-fifths">
                    <h2 class="title is-3">Abstract</h2>
                    <div class="content has-text-justified">
                          This paper tackles category-level pose estimation of articulated objects in robotic manipulation tasks and introduces a new benchmark dataset. While recent methods estimate part poses and sizes at the category level, they often
                        rely on geometric cues and complex multi-stage pipelines
                        that first segment parts from the point cloud, followed by
                        Normalized Part Coordinate Space (NPCS) estimation for
                        6D poses. These approaches overlook dense semantic cues
                        from RGB images, leading to suboptimal accuracy, particularly for objects with small parts. To address these limita-
                        tions, we propose a single-stage Network, CAP-Net, for estimating the 6D poses and sizes of Categorical Articulated
                        Parts. This method combines RGB-D features to generate
                        instance segmentation and NPCS representations for each
                        part in an end-to-end manner. CAP-Net uses a unified network to simultaneously predict point-wise class labels, cen-
                        troid offsets, and NPCS maps. A clustering algorithm then
                        groups points of the same predicted class based on their estimated centroid distances to isolate each part. Finally, the
                        NPCS region of each part is aligned with the point cloud to
                        recover its final pose and size. To bridge the sim-to-real domain gap, we introduce the RGBD-Art dataset, the largest
                        RGB-D articulated dataset to date, featuring photorealistic
                        RGB images and depth noise simulated from real sensors.
                        Experimental evaluations on the RGBD-Art dataset demonstrate that our method significantly outperforms the state-of-the-art approach. Real-world deployments of our model
                        in robotic tasks underscore its robustness and exceptional
                        sim-to-real transfer capabilities, confirming its substantial
                        practical utility.
                        <!-- <p>
                            <b>Liquid perception</b> is critical for robotic pouring tasks. It usually requires the robust visual detection of flowing liquid.
                            However, while recent works have shown promising results in liquid perception, they typically require labeled data for model training, a process that is both time-consuming and reliant on human labor.
                        </p>

                        <p>
                            To this end, this paper proposes a simple yet effective framework <span style="font-size: larger; color: cornflowerblue; ">PourIt!</span>, to serve as a tool for robotic pouring tasks.
                            We design a simple data collection pipeline that only needs image-level labels to reduce the reliance on tedious pixel-wise annotations.
                            Then, a binary classification model is trained to generate Class Activation Map (CAM) that focuses on the visual difference between these two kinds of collected data, i.e., the existence of liquid drop or not.
                            We also devise a feature contrast strategy to improve the quality of the CAM, thus entirely and tightly covering the actual liquid regions.
                            Then, the container pose is further utilized to facilitate the 3D point cloud recovery of the detected liquid region.
                            Finally, the liquid-to-container distance is calculated for visual closed-loop control of the physical robot.
                        </p>

                        <p>
                            To validate the effectiveness of our proposed method, we also contribute a novel dataset for our task and name it <span style="font-size: larger; color: cornflowerblue; ">PourIt!</span> dataset.
                            Extensive results on this dataset and physical Franka robot have shown the utility and effectiveness of our method in the robotic pouring tasks.
                        </p> -->
                    </div>
                </div>
            </div>
        </div>
        <!-- Paper video. -->
        <!-- <div align="center">
            <img src="./resources/images/pourit_logo_robot.jpg" width="30%" />
        </div>
        <div class="columns is-centered has-text-centered">
            <div class="column is-three-fifths">
                <div class="publication-video">
                    <iframe style="position: absolute; width: 100%; height: 100%; left: 0; top: 0;" src="https://player.bilibili.com/player.html?aid=616136613&bvid=BV1Th4y1L77j&cid=1204194164&page=1&high_quality=1&danmaku=0" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>
                </div>
                <br>

                </br>
                <div class="publication-video">
                   <iframe width="1254" height="705" src="https://www.youtube.com/embed/R5SpiV0658Q" title="PourIt!: Robotic Maestros&#39;s Elegance in Liquid Symphony (ICCV2023)" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                </div>
            </div>

        </div> -->
        <!--/ Paper video. -->
    </section>


    <section class="section">
        <div class="container is-max-desktop">

            <!-- Overview. -->
            <div class="columns is-centered" style="margin-top: 15px">
                <div class="column is-full-width">
                    <h2 class="title is-3">Method Overview</h2>
                    <img src="./resources/fig/pipeline.png" width="120%"/>
                    <div class="content has-text-justified" style="padding-top: 15px">
                        <p>The Architecture overview of our proposed <span style="font-size: larger; color: cornflowerblue; ">CAP-Net</span> framework.
                            CAP-Net uses pretrained vision backbones, SAM2 and FeatUp, 
                            to extract dense semantic features, which are then fused with the point cloud in a point-wise manner. 
                            The enriched point cloud features are passed into PointNet++ for further processing. 
                            These features are then used by three parallel modules to predict semantic labels, centroid offsets, 
                            and NPCS maps. A clustering algorithm groups points with the same semantic label based on centroid distances to isolate each possible part. 
                            Finally, an alignment algorithm matches the predicted NPCS map with the real point cloud to estimate each part’s pose and size.
                    </div>

                </div>
            </div>

        </div>
    </section>





    <section class="section">
        <div class="container is-max-desktop">

            <!-- Overview. -->
            <div class="columns is-centered" style="margin-top: 15px">
                <div class="column is-full-width">
                    <h2 class="title is-3">Exemplars of our RGBD-Art dataset.</h2>
                    <div align="center">
                        <img src="./resources/fig/examplar.jpg" width="70%"/>
                        <img src="./resources/fig/dataset_table.png" width="70%"/>


                        <p>Building on the objects used in the GAPartNet dataset, we incorporate existing resources from PartNet-Mobility that provide URDF models of articulated objects with unified annotations for each part type. 
                        Our dataset contains 9 categories of articulated part types, including:<span style="font-style: italic">line fixed handle</span>, 
                        <span style="font-style: italic">round fixed handle</span>, 
                        <span style="font-style: italic">hinge handle</span>, 
                        <span style="font-style: italic">hinge lid</span>, 
                        <span style="font-style: italic">slider lid</span>, 
                        <span style="font-style: italic">slider button</span>, 
                        <span style="font-style: italic">slider drawer</span>, 
                        <span style="font-style: italic">hinge door</span>
                        and <span style="font-style: italic">hinge knob</span>.
                         Each instance contains multiple classes of parts. To enhance realism, we place each instance on a flat surface or a desk, simulating typical backgrounds found in household settings.
                        For each instance, we place it in two random backgrounds and, for each background, randomly sample 60 camera views to render RGB-D images. In total, we generate 63K images, complete with semantic labels and pose annotations.</p>
                    </div>


                </div>
            </div>

        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">

            <!-- Overview. -->
            <div class="columns is-centered" style="margin-top: 15px">
                <div class="column is-full-width">
                    <h2 class="title is-3">Qualatative Results. </h2>
                    <div align="center">
                        <img src="./resources/fig/quality.png" width="120%"/>
                        <!-- <img src="./resources/images/vis_robotics.jpg"/> -->
                    </div>
                </div>
            </div>

        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">

            <!-- Overview. -->
            <div class="columns is-centered" style="margin-top: 15px">
                <div class="column is-full-width">
                    <h2 class="title is-3">Sim to Real video</h2>
                    <video poster="" id="steve" autoplay controls muted loop playsinline height="100%">
                        <source src="./resources/videos/CVPR2025.mp4" type="video/mp4">
                    </video>
                    

                </div>
            </div>

        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">

            <!-- Overview. -->
            <div class="columns is-centered" style="margin-top: 15px">
                <div class="column is-full-width">
                    <h2 class="title is-3">More Qualatative Results on Datasets</h2>
                    <div align="center">
                        <img src="./resources/fig/dataset_qualit.png"/>
                        <!-- <img src="./resources/images/vis_dataset_pourit_more1.jpg"/>
                        <img src="./resources/images/vis_dataset_pourit_more2.jpg"/> -->
                    </div>

                </div>
            </div>

        </div>
    </section>


<!--    <section class="hero is-light is-small">-->
<!--        <div class="hero-body">-->
<!--            <div class="container">-->
<!--                <h2 class="title is-3">Textured Objaverse Objects</h2>-->

<!--                <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">Geometry </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">CLIPMesh </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">Latent-Paint </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">Ours </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="compass_geo" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="compass_clipmesh" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="compass_latentpaint" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="compass_ours" class="render_div"></div>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div style="text-align: center; font-size: large; height: 50px;">"a compass" </div>-->

<!--                <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">Geometry </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">CLIPMesh </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">Latent-Paint </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">Ours </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="ambulance_geo" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="ambulance_clipmesh" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="ambulance_latentpaint" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="ambulance_ours" class="render_div"></div>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div style="text-align: center; font-size: large; height: 50px;">"an ambulance" </div>-->

<!--                &lt;!&ndash; <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="backpack_geo" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="backpack_clipmesh" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="backpack_latentpaint" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="backpack_ours" class="render_div"></div>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div style="text-align: center;">"a backpack" </div> &ndash;&gt;-->

<!--                &lt;!&ndash; <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="dumpster_geo" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="dumpster_clipmesh" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="dumpster_latentpaint" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="dumpster_ours" class="render_div"></div>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div style="text-align: center;">"a dumpster" </div> &ndash;&gt;-->

<!--            </div>-->
<!--        </div>-->
<!--    </section>-->

<!--    <section class="hero is-light is-small">-->
<!--        <div class="hero-body">-->
<!--            <div class="container">-->
<!--                <h2 class="title is-3">Creative Texture Synthesis</h2>-->

<!--                <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">"baroque Porsche" </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">"wooden Porsche" </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">"cyberpunk Porsche" </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">"Lego Porsche" </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="baroque_porsche" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="wooden_porsche" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="cyberpunk_porsche" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="lego_porsche" class="render_div"></div>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div style="text-align: center; font-size: large; height: 50px;">Porsche in different styles </div>-->

<!--                <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">"airplane </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">"crocodile" </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">"hippo" </div>-->
<!--                    </div>-->
<!--                    <div>-->
<!--			            <div style="text-align: center; font-size: large;">"sheep" </div>-->
<!--                    </div>-->
<!--                </div>-->
<!--                <div id="results-carousel" class="carousel results-carousel">-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="airplane_porsche" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="crocodile_porsche" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="hippo_porsche" class="render_div"></div>-->
<!--                    </div>-->
<!--                    <div class="item item-steve render_wrapper">-->
<!--			            <div id="sheep_porsche" class="render_div"></div>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div style="text-align: center; font-size: large; height: 50px;">Porsche as other objects </div>-->

<!--            </div>-->
<!--        </div>-->
<!--    </section>-->
<!-- lin2023pourit,
  title={PourIt!: Weakly-supervised Liquid Perception from a Single Image for Visual Closed-Loop Robotic Pouring},
  author={Lin, Haitao and Fu, Yanwei and Xue, Xiangyang},
  journal={International Conference on Computer Vision (ICCV)},
  year={2023}, -->
<section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{
<!--  url={https://arxiv.org/abs/2207.13691},-->
}</code></pre>
    </div>
</section>

<!--    <section class="section" id="BibTeX">-->
<!--        <div class="container is-max-desktop content">-->
<!--            <h2 class="title">BibTeX</h2>-->
<!--            <pre>-->
<!--<code>-->
<!--@article{lin2023pourit,-->
<!--    title={PourIt!: Weakly-supervised Liquid Perception from a Single Image for Visual Closed-Loop Robotic Pouring},-->
<!--    author={Chen, Dave Zhenyu and Siddiqui, Yawar and Lee, Hsin-Ying and Tulyakov, Sergey and Nie{\ss}ner, Matthias},-->
<!--    journal={arXiv preprint arXiv:2303.11396},-->
<!--    year={2023},-->
<!--}-->
<!--</code></pre>-->
<!--        </div>-->
<!--    </section>-->

    <section class="section">
        <div class="container is-max-desktop content">
            <h2 class="title">Acknowledgements</h2>
            <!-- We thank <a href="https://storage.googleapis.com/www.connorschenck.com/index.html">Dr. Connor Schenck</a>
            for providing the <a href="https://rse-lab.cs.washington.edu/lpd/">UW Liquid Pouring Dataset</a>. -->
        </div>
    </section>


    <footer class="footer">
        <div class="container">
            <div class="content has-text-centered">
                <a class="icon-link" href="./resources/images/arXiv_pre.pdf">
                    <i class="fas fa-file-pdf"></i>
                </a>
                <a class="icon-link" href="https://github.com/hetolin/PourIt" class="external-link" disabled>
                    <i class="fab fa-github"></i>
                </a>
            </div>
            <div class="columns is-centered">
                <div class="column is-8">
                    <div class="content">
                        <p style="text-align:center">
                            Source code mainly borrowed from <a href="https://niessnerlab.org/members/yawar_siddiqui/profile.html">Yawar Siddiqui</a>'s <a
                                href="https://nihalsid.github.io/texturify/">Texturify website</a>.
                        </p>
                        <p style="text-align:center">
                            Please contact <a href="hetolin@163.com">Haitao Lin</a> for feedback and questions.
                        </p>

                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Import maps polyfill -->
    <!-- Remove this when import maps will be widely supported -->
    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>

    <script type="importmap">
        {
            "imports": {
                "three": "./js/three.module.js"
            }
        }
    </script>

    <script type="module">

        import * as THREE from 'three';

        import { PLYLoader } from './js/PLYLoader.js';
        import { OBJLoader } from './js/OBJLoader.js';
        import { MTLLoader } from './js/MTLLoader.js';
        import { OrbitControls } from './js/OrbitControls.js'
        let div_to_scene = {
            "compass": {},
            "ambulance": {},
            "backpack": {},
            "dumpster": {},
            "baroque": {},
            "wooden": {},
            "cyberpunk": {},
            "lego": {},
            "airplane": {},
            "crocodile": {},
            "hippo": {},
            "sheep": {}
        };
        let div_camera = {
            "compass": null,
            "ambulance": null,
            "backpack": null,
            "dumpster": null,
            "baroque": null,
            "wooden": null,
            "cyberpunk": null,
            "lego": null,
            "airplane": null,
            "crocodile": null,
            "hippo": null,
            "sheep": null,
        };

        let mouse_button_down = false;
        let list_of_orbit_controls = []
        let style_camera = null;
        let render_colors = true;
        let style_id = "0"

        function setup_camera(div_name){
            let container = document.getElementById(div_name);
            let width = container.parentElement.clientWidth;
            let height = container.parentElement.clientHeight;
            console.log(width, height)
            let camera = new THREE.PerspectiveCamera( 35, width / height, 0.1, 50 );
            let camera_init_position = new THREE.Vector3( -1, 0.5, 1 );
            if (div_name.includes("compass")){
                camera_init_position = new THREE.Vector3( 1, 1.5, 1 );
            }
            else if (div_name.includes("ambulance")) {
                camera_init_position = new THREE.Vector3( -1.1, 0.5, 1.1 );
            }
            // else if (div_name.includes("backpack")) {
            //     camera_init_position = new THREE.Vector3( -1.5, 0.5, 1.5 );
            // }
            camera.position.set(camera_init_position.x, camera_init_position.y, camera_init_position.z);
            return camera;
        }

        function setup_render_divs(div_name, obj_name, obj_path, mtl_path, texture_path){
            if (div_camera[obj_name] == null) {
                div_camera[obj_name] = setup_camera(div_name)
            }

            let orbit_control = create_render_div(div_camera[obj_name], div_name, obj_name, obj_path, mtl_path, texture_path)
            list_of_orbit_controls.push(orbit_control)
        }

        function create_render_div(camera, div_id, obj_name, obj_path, mtl_path, texture_path) {
            let container;
            let renderer, controls;

            init();
            animate();

            function init() {

                container = document.getElementById(div_id);
                let width = container.parentElement.clientWidth;
                let height = container.parentElement.clientHeight;


                div_to_scene[obj_name][div_id] = new THREE.Scene();
                div_to_scene[obj_name][div_id].background = new THREE.Color( 0xffffff );

                // ObJ file

                const objLoader  = new OBJLoader();
                const textureLoader = new THREE.TextureLoader();
                const mtlLoader = new MTLLoader();

                mtlLoader.load(mtl_path, function ( materials ) {
                    materials.preload();
                    objLoader
                        .setMaterials( materials )
                        .load( obj_path, function ( object ) {
                            textureLoader
                                .load( texture_path, function ( texture ) {
                                    object.traverse (function ( child ) {
                                        if ( child instanceof THREE.Mesh ) {
                                            child.material.map = texture;
                                        }
                                    });

                                    div_to_scene[obj_name][div_id].add( object );
                                });
                        });
                });

                div_to_scene[obj_name][div_id].add( new THREE.HemisphereLight( 0x333333, 0x222222 ) );
                addShadowedLight(div_to_scene[obj_name][div_id], 1, 1, 1, 0xffffff, 1 );
                addShadowedLight(div_to_scene[obj_name][div_id],  -1, -1, - 1, 0xffffff, 0.5 );

                // renderer

                renderer = new THREE.WebGLRenderer( { antialias: true } );
                renderer.setPixelRatio( window.devicePixelRatio );
                renderer.setSize( width, height);
                renderer.outputEncoding = THREE.sRGBEncoding;

                renderer.shadowMap.enabled = true;

                container.appendChild( renderer.domElement );

                controls = new OrbitControls(camera, renderer.domElement)
                controls.enableDamping = false

                // resize

                window.addEventListener( 'resize', onWindowResize );

        }
            function onWindowResize() {
                let width = container.clientWidth;
                let height = container.clientHeight;
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
                renderer.setSize( width, height );
            }
            function animate() {
                requestAnimationFrame( animate );
                render();
            }

            function render() {
                renderer.render( div_to_scene[obj_name][div_id], camera );
                controls.update();
            }

            return controls;
        }

        function addShadowedLight(scene, x, y, z, color, intensity ) {

            const directionalLight = new THREE.DirectionalLight( color, intensity );
            directionalLight.position.set( x, y, z );
            scene.add( directionalLight );

            directionalLight.castShadow = true;

            const d = 1;
            directionalLight.shadow.camera.left = - d;
            directionalLight.shadow.camera.right = d;
            directionalLight.shadow.camera.top = d;
            directionalLight.shadow.camera.bottom = - d;

            directionalLight.shadow.camera.near = 1;
            directionalLight.shadow.camera.far = 4;

            directionalLight.shadow.mapSize.width = 1024;
            directionalLight.shadow.mapSize.height = 1024;

            directionalLight.shadow.bias = - 0.001;

        }

        document.addEventListener('keydown', logKey);

        function logKey(evt) {
            if (evt.keyCode === 82 && !mouse_button_down) {
                reset_orbit_controls()
            }
        }

        function reset_orbit_controls() {
            list_of_orbit_controls.forEach(oc => {
                oc.reset()
            })
        }

        document.body.onmousedown = function(evt) {
            if (evt.button === 0)
                mouse_button_down = true
        }
        document.body.onmouseup = function(evt) {
            if (evt.button === 0)
                mouse_button_down = false
        }

        window.onload = function() {
            let slider = document.getElementsByClassName("slider")[0]
            slider.removeAttribute("tabIndex")
            // slider.addEventListener("mouseout", reset_orbit_controls);

            // const qualitative = ["compass", "ambulance", "backpack", "dumpster"];
            const qualitative = ["compass", "ambulance"];

            qualitative.forEach(element => {
                setup_render_divs(element+"_geo", element,
                './samples/qualitative/'+element+'/geo/mesh_normalized.obj',
                './samples/qualitative/'+element+'/geo/mesh_normalized.mtl',
                './samples/qualitative/'+element+'/geo/mesh_normalized.png'
                );
                setup_render_divs(element+"_clipmesh", element,
                    './samples/qualitative/'+element+'/clipmesh/mesh_normalized.obj',
                    './samples/qualitative/'+element+'/clipmesh/mesh_normalized.mtl',
                    './samples/qualitative/'+element+'/clipmesh/mesh_normalized.png'
                );
                setup_render_divs(element+"_latentpaint", element,
                    './samples/qualitative/'+element+'/latentpaint/mesh_normalized.obj',
                    './samples/qualitative/'+element+'/latentpaint/mesh_normalized.mtl',
                    './samples/qualitative/'+element+'/latentpaint/mesh_normalized.png'
                );
                setup_render_divs(element+"_ours", element,
                    './samples/qualitative/'+element+'/ours/mesh_normalized.obj',
                    './samples/qualitative/'+element+'/ours/mesh_normalized.mtl',
                    './samples/qualitative/'+element+'/ours/mesh_normalized.png'
                );
            });


            const styles = ["baroque", "wooden", "cyberpunk", "lego"];
            styles.forEach(element => {
                setup_render_divs(element+"_porsche", element,
                './samples/different_style/'+element+'_porsche/mesh_normalized.obj',
                './samples/different_style/'+element+'_porsche/mesh_normalized.mtl',
                './samples/different_style/'+element+'_porsche/mesh_normalized.png'
                );
            });

            const others = ["airplane", "crocodile", "hippo", "sheep"];
            others.forEach(element => {
                setup_render_divs(element+"_porsche", element,
                './samples/wrong_prompt/'+element+'/mesh_normalized.obj',
                './samples/wrong_prompt/'+element+'/mesh_normalized.mtl',
                './samples/wrong_prompt/'+element+'/mesh_normalized.png'
                );
            });

        };

    </script>
</body>

</html>